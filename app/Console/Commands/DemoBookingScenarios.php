<?php

namespace App\Console\Commands;

use Illuminate\Console\Command;
use App\Actions\CreateOrUpdateCompanyAction;
use App\Actions\CreateTimetableFromJsonAction;
use App\Actions\StoreResourceTypeAction;
use App\Actions\StoreResourceAction;
use App\Services\Logging\BookingLoggerService;
use App\Models\Company;
use App\Models\Resource;
use App\Http\Controllers\Api\BookingController;
use App\Http\Requests\CreateBookingRequest;
use App\Http\Requests\CancelBookingRequest;
use App\Http\Requests\RescheduleBookingRequest;
use App\Http\Requests\GetSlotsRequest;
use App\Http\Requests\CheckAvailabilityRequest;
use Illuminate\Http\Request;
use Carbon\Carbon;

class DemoBookingScenarios extends Command
{
    protected $signature = 'demo:booking-scenarios
                            {scenario? : –ö–æ–Ω–∫—Ä–µ—Ç–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞ (1-8)}
                            {--all : –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏}
                            {--list : –ü–æ–∫–∞–∑–∞—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏}';

    protected $description = '–ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å–∏—Å—Ç–µ–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è';

    private int $currentCompanyId;
    private int $currentResourceId;
    private BookingController $bookingController;

    public function __construct(
        private CreateOrUpdateCompanyAction $createCompanyAction,
        private CreateTimetableFromJsonAction $createTimetableAction,
        private StoreResourceTypeAction $storeResourceTypeAction,
        private StoreResourceAction $storeResourceAction
    ) {
        parent::__construct();
        $this->bookingController = app(BookingController::class);
    }

    public function handle(): int
    {
        if ($this->option('list')) {
            return $this->showScenarios();
        }

        $this->info('üöÄ –ó–∞–ø—É—Å–∫ –¥–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–∏ —Å–∏—Å—Ç–µ–º—ã –±—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è');
        $this->line('==================================================');

        $scenarios = $this->getScenariosToRun();

        foreach ($scenarios as $scenario) {
            $this->runScenario($scenario);
        }

        $this->info('üéâ –í—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –∑–∞–≤–µ—Ä—à–µ–Ω—ã!');
        BookingLoggerService::info('–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≤—Å–µ—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ –∑–∞–≤–µ—Ä—à–µ–Ω–∞');

        return 0;
    }

    /**
     * –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø–∏—Å–æ–∫ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º
     */
    private function showScenarios(): int
    {
        $this->info('üìã –î–û–°–¢–£–ü–ù–´–ï –î–ï–ú–û–ù–°–¢–†–ê–¶–ò–û–ù–ù–´–ï –°–¶–ï–ù–ê–†–ò–ò:');
        $this->line('');

        $scenarios = [
            1 => 'üíà –°–¶–ï–ù–ê–†–ò–ô 1: –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',
            2 => 'üè¢ –°–¶–ï–ù–ê–†–ò–ô 2: –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã + —Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ',
            3 => 'üèãÔ∏è –°–¶–ï–ù–ê–†–ò–ô 3: –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã + –≥—Ä—É–ø–ø–æ–≤—ã–µ –±—Ä–æ–Ω–∏',
            4 => 'üíé –°–¶–ï–ù–ê–†–ò–ô 4: –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã + —Å—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è',
            5 => 'üè® –°–¶–ï–ù–ê–†–ò–ô 5: –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä - –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –±—Ä–æ–Ω–∏ + —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏',
            6 => '‚ö° –°–¶–ï–ù–ê–†–ò–ô 6: –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä vs –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
            7 => 'üíÖ –°–¶–ï–ù–ê–†–ò–ô 7: –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã - –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º–∏',
            8 => 'üè¢ –°–¶–ï–ù–ê–†–ò–ô 8: –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä - –°–º–µ—à–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ + –ø–µ—Ä–µ—Ä—ã–≤—ã'
        ];

        foreach ($scenarios as $id => $description) {
            $this->line("  {$id}. {$description}");
        }

        $this->line("\nüí° –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:");
        $this->line("  php artisan demo:booking-scenarios --all      # –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏");
        $this->line("  php artisan demo:booking-scenarios 1          # –ó–∞–ø—É—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ —Å—Ü–µ–Ω–∞—Ä–∏–π 1");
        $this->line("  php artisan demo:booking-scenarios --list     # –ü–æ–∫–∞–∑–∞—Ç—å —ç—Ç–æ—Ç —Å–ø–∏—Å–æ–∫");

        return 0;
    }

    /**
     * –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –∫–∞–∫–∏–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏ –Ω—É–∂–Ω–æ –∑–∞–ø—É—Å—Ç–∏—Ç—å
     */
    private function getScenariosToRun(): array
    {
        if ($this->option('all')) {
            return range(1, 8);
        }

        $scenario = $this->argument('scenario');
        if ($scenario) {
            return [$scenario];
        }

        // –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–π –≤—ã–±–æ—Ä –µ—Å–ª–∏ –Ω–µ —É–∫–∞–∑–∞–Ω—ã –ø–∞—Ä–∞–º–µ—Ç—Ä—ã
        $choice = $this->choice(
            'üéØ –í—ã–±–µ—Ä–∏—Ç–µ —Å—Ü–µ–Ω–∞—Ä–∏–π –¥–ª—è –∑–∞–ø—É—Å–∫–∞:',
            [
                1 => '1. üíà –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è (–∞–≤—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã)',
                2 => '2. üè¢ –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è (—Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã)',
                3 => '3. üèãÔ∏è –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ (–ª–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤, –≥—Ä—É–ø–ø–æ–≤—ã–µ –±—Ä–æ–Ω–∏)',
                4 => '4. üíé –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ (—Å—Ç—Ä–æ–≥–∏–µ –ø—Ä–∞–≤–∏–ª–∞, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ)',
                5 => '5. üè® –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä (–º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã–µ –±—Ä–æ–Ω–∏)',
                6 => '6. ‚ö° –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π (–∞–¥–º–∏–Ω vs –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å)',
                7 => '7. üíÖ –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã (–ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ –¥–Ω–∏, –ø–µ—Ä–µ—Ä—ã–≤—ã)',
                8 => '8. üè¢ –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä (—Å–ª–æ–∂–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã)',
                'all' => 'ALL. üöÄ –ó–∞–ø—É—Å—Ç–∏—Ç—å –≤—Å–µ —Å—Ü–µ–Ω–∞—Ä–∏–∏'
            ],
            'all'
        );

        return $choice === 'all' ? range(1, 8) : [explode('.', $choice)[0]];
    }

    /**
     * –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function runScenario(int $scenarioId): void
    {
        $this->info("\nüé¨ –ó–ê–ü–£–°–ö –°–¶–ï–ù–ê–†–ò–Ø {$scenarioId}");
        $this->line(str_repeat('‚îÄ', 60));

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞—á–∞–ª–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è
        BookingLoggerService::info("–ù–∞—á–∞–ª–æ —Å—Ü–µ–Ω–∞—Ä–∏—è {$scenarioId}", ['scenario_id' => $scenarioId]);

        // –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–µ–¥—ã–¥—É—â–µ–≥–æ –∑–∞–ø—É—Å–∫–∞
        $this->cleanupScenarioData($scenarioId);

        // –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è: —Å–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è, —Ä–µ—Å—É—Ä—Å–æ–≤
        $setupData = $this->setupScenario($scenarioId);

        if (!$setupData) {
            $this->error("‚ùå –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Å—Ü–µ–Ω–∞—Ä–∏—è {$scenarioId}");
            BookingLoggerService::error("–°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId} –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω");
            return;
        }

        $this->currentResourceId = $setupData['resource_id'];

        // –ó–∞–ø—É—Å–∫ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è –ø–æ –Ω–æ–º–µ—Ä—É
        $method = "runScenario{$scenarioId}";
        if (method_exists($this, $method)) {
            $this->$method($setupData);
        } else {
            $this->error("‚ùå –ú–µ—Ç–æ–¥ {$method} –Ω–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω");
        }

        $this->info("‚úÖ –°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId} –∑–∞–≤–µ—Ä—à–µ–Ω");
        $this->storeScenarioResults($scenarioId, $setupData);

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è
        BookingLoggerService::info("–°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId} –∑–∞–≤–µ—Ä—à–µ–Ω", [
            'scenario_id' => $scenarioId,
            'resource_id' => $this->currentResourceId
        ]);
    }

    /**
     * –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –æ–∫—Ä—É–∂–µ–Ω–∏—è –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è: –∫–æ–º–ø–∞–Ω–∏—è, —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ, —Ç–∏–ø —Ä–µ—Å—É—Ä—Å–∞, —Ä–µ—Å—É—Ä—Å
     */
    private function setupScenario(int $scenarioId): ?array
    {
        $this->info("‚öôÔ∏è –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å—Ü–µ–Ω–∞—Ä–∏—è {$scenarioId}...");

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–∞–Ω–∏–∏ —Å —É–Ω–∏–∫–∞–ª—å–Ω—ã–º ID –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è
        $companyId = $scenarioId * 100;
        $company = $this->createCompanyAction->execute(
            $companyId,
            "–î–µ–º–æ –∫–æ–º–ø–∞–Ω–∏—è –°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId}"
        );
        $this->currentCompanyId = $company->id;

        // –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è
        $timetableData = $this->getTimetableForScenario($scenarioId);
        $timetable = $this->createTimetableAction->execute(
            $company->id,
            $timetableData['schedule'],
            $timetableData['type']
        );

        // –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è —Ç–∏–ø–∞ —Ä–µ—Å—É—Ä—Å–∞
        $resourceTypeConfig = $this->getResourceConfigForScenario($scenarioId);
        $resourceTypeData = [
            'company_id' => $company->id,
            'timetable_id' => $timetable->id,
            'type' => "type_scenario_{$scenarioId}",
            'name' => "–¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞ –°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId}",
            'description' => $this->getScenarioDescription($scenarioId),
            'resource_config' => $resourceTypeConfig
        ];

        $resourceType = $this->storeResourceTypeAction->execute($resourceTypeData);

        // –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Ä–µ—Å—É—Ä—Å–∞
        $resourceData = [
            'company_id' => $company->id,
            'timetable_id' => $timetable->id,
            'resource_type_id' => $resourceType->id,
            'options' => $this->getResourceOptionsForScenario($scenarioId),
            'resource_config' => $this->getResourceOverridesForScenario($scenarioId)
        ];

        $resource = $this->storeResourceAction->execute($resourceData);

        // –í—ã–≤–æ–¥ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
        $this->info("‚úÖ –ö–æ–º–ø–∞–Ω–∏—è: {$company->name} (ID: {$company->id})");
        $this->info("‚úÖ –†–∞—Å–ø–∏—Å–∞–Ω–∏–µ: {$timetable->type}");
        $this->info("‚úÖ –¢–∏–ø —Ä–µ—Å—É—Ä—Å–∞: {$resourceType->name}");
        $this->info("‚úÖ –†–µ—Å—É—Ä—Å: {$this->getResourceName($scenarioId)} (ID: {$resource->id})");
        $this->info("üìã –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è: " . $this->getConfigSummary($resourceTypeConfig));

        // –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
        BookingLoggerService::info("–°—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId} –Ω–∞—Å—Ç—Ä–æ–µ–Ω", [
            'company_id' => $company->id,
            'timetable_id' => $timetable->id,
            'resource_type_id' => $resourceType->id,
            'resource_id' => $resource->id
        ]);

        return [
            'company_id' => $company->id,
            'timetable_id' => $timetable->id,
            'resource_type_id' => $resourceType->id,
            'resource_id' => $resource->id
        ];
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 1: –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã + –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
     * ===========================================================================
     */
    private function runScenario1(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüíà –°–¶–ï–ù–ê–†–ò–ô 1: –ü–ê–†–ò–ö–ú–ê–•–ï–†–°–ö–ê–Ø");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –∞–≤—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã 60 –º–∏–Ω, –ø–µ—Ä–µ—Ä—ã–≤ 13:15-14:15");

        BookingLoggerService::info("–ù–∞—á–∞–ª–æ –°—Ü–µ–Ω–∞—Ä–∏—è 1: –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è");

        // –®–ê–ì 1: –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –¥–ª—è –æ—Ç–æ–±—Ä–∞–∂–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é
        $this->info("\nüìÖ –®–ê–ì 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤...");
        $slots = $this->getSlots($resourceId, '2024-01-15', 8);
        $this->info("   üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã: " . count($slots));
        $this->info("   üïí –ü—Ä–∏–º–µ—Ä—ã: " . implode(', ', array_slice($slots, 0, 3)));

        // –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω—å –Ω–∞ –ø–æ—Å–ª–µ–¥–Ω–∏–π —Å–ª–æ—Ç –¥–æ –ø–µ—Ä–µ—Ä—ã–≤–∞
        $this->info("\n‚úÖ –®–ê–ì 2: –ë—Ä–æ–Ω—å –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ —Å–ª–æ—Ç–∞ –¥–æ –ø–µ—Ä–µ—Ä—ã–≤–∞...");
        $booking1 = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-15 12:00:00',
            'end' => '2024-01-15 13:00:00',
            'booker' => ['name' => '–ê–Ω–Ω–∞ –ò–≤–∞–Ω–æ–≤–∞', 'email' => 'anna@example.com']
        ]);
        $this->checkStatus($booking1, 'confirmed', "–ë—Ä–æ–Ω—å –∞–≤—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");

        // –®–ê–ì 3: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ —Å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ–º –ø–µ—Ä–µ—Ä—ã–≤–∞ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 3: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ —Å –ø–µ—Ä–µ—Å–µ—á–µ–Ω–∏–µ–º –ø–µ—Ä–µ—Ä—ã–≤–∞...");
        try {
            $this->createBooking([
                'resource_id' => $resourceId,
                'start' => '2024-01-15 12:45:00',
                'end' => '2024-01-15 13:45:00',
                'booker' => ['name' => '–ö–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã–π –∫–ª–∏–µ–Ω—Ç']
            ]);
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        // –®–ê–ì 4: –ë—Ä–æ–Ω—å –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—Ç–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞
        $this->info("\n‚úÖ –®–ê–ì 4: –ë—Ä–æ–Ω—å –ø–µ—Ä–≤–æ–≥–æ —Å–ª–æ—Ç–∞ –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞...");
        $booking2 = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-15 14:15:00',
            'end' => '2024-01-15 15:15:00',
            'booker' => ['name' => '–ü–µ—Ç—Ä –°–∏–¥–æ—Ä–æ–≤']
        ]);
        $this->checkStatus($booking2, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞ —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤
        $this->info("\nüîç –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤...");
        $this->testBoundaryCases($resourceId);

        // –®–ê–ì 6: –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–æ–º
        $this->info("\nüîÑ –®–ê–ì 6: –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏ –∫–ª–∏–µ–Ω—Ç–æ–º...");
        $canceledBooking = $this->cancelBooking($booking1['id'], 'client', '–ü–ª–∞–Ω—ã –∏–∑–º–µ–Ω–∏–ª–∏—Å—å');
        $this->checkStatus($canceledBooking, 'cancelled_by_client', "–ë—Ä–æ–Ω—å –æ—Ç–º–µ–Ω–µ–Ω–∞ –∫–ª–∏–µ–Ω—Ç–æ–º");

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 1 –ó–ê–í–ï–†–®–ï–ù: –í—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 2: –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã + —Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
     * ===========================================================================
     */
    private function runScenario2(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüè¢ –°–¶–ï–ù–ê–†–ò–ô 2: –ü–ï–†–ï–ì–û–í–û–†–ù–ê–Ø –ö–û–ú–ù–ê–¢–ê");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏—Ö —Å–ª–æ—Ç–æ–≤ —Å —Ä—É—á–Ω—ã–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: —Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã 30 –º–∏–Ω, —Ä–∞–∑–Ω—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞");

        // –®–ê–ì 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω—å –≤–Ω–µ —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–æ–≥–æ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è
        $this->info("\nüë®‚Äçüíº –®–ê–ì 1: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω—å –≤–Ω–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è...");
        $adminBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-16 10:00:00',
            'end' => '2024-01-16 11:30:00',
            'is_admin' => true,
            'booker' => ['name' => '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'type' => 'admin']
        ]);
        $this->checkStatus($adminBooking, 'confirmed', "–ë—Ä–æ–Ω—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –∞–≤—Ç–æ-–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");

        // –®–ê–ì 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω—å (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)
        $this->info("\nüë§ –®–ê–ì 2: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –±—Ä–æ–Ω—å (—Ç—Ä–µ–±—É–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è)...");
        $userBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-16 13:00:00',
            'end' => '2024-01-16 14:00:00',
            'booker' => ['name' => '–ü–µ—Ç—Ä –°–∏–¥–æ—Ä–æ–≤', 'email' => 'peter@example.com']
        ]);
        $this->checkStatus($userBooking, 'pending', "–ë—Ä–æ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è");

        // –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–ª–æ—Ç—ã —Å —É—á–µ—Ç–æ–º pending –±—Ä–æ–Ω–∏
        $this->info("\nüìÖ –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–ª–æ—Ç–æ–≤ —Å —É—á–µ—Ç–æ–º –æ–∂–∏–¥–∞—é—â–µ–π –±—Ä–æ–Ω–∏...");
        $slots = $this->getSlots($resourceId, '2024-01-16', 8);
        $this->info("   üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã: " . count($slots));

        // –®–ê–ì 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        $this->info("\n‚úÖ –®–ê–ì 4: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º...");
        $confirmedBooking = $this->confirmBooking($userBooking['id']);
        $this->checkStatus($confirmedBooking, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º");

        // –®–ê–ì 5: –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã –ø—Ä–æ—Å—Ä–æ—á–µ–Ω–Ω–æ–π –±—Ä–æ–Ω–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 5: –ü–æ–ø—ã—Ç–∫–∞ –ø–æ–∑–¥–Ω–µ–π –æ—Ç–º–µ–Ω—ã...");
        try {
            $pastBooking = $this->createBooking([
                'resource_id' => $resourceId,
                'start' => '2024-01-10 10:00:00',
                'end' => '2024-01-10 11:00:00',
                'is_admin' => true,
                'booker' => ['name' => '–¢–µ—Å—Ç –æ—Ç–º–µ–Ω—ã']
            ]);

            $this->cancelBooking($pastBooking['id'], 'client', '–ü–æ–∑–¥–Ω—è—è –æ—Ç–º–µ–Ω–∞');
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π –¥–ª—è –ø–æ–∑–¥–Ω–µ–π –æ—Ç–º–µ–Ω—ã!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 2 –ó–ê–í–ï–†–®–ï–ù: –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã –∏ —Ä—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 3: –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ - –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã + –≥—Ä—É–ø–ø–æ–≤—ã–µ –±—Ä–æ–Ω–∏
     * ===========================================================================
     */
    private function runScenario3(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüèãÔ∏è –°–¶–ï–ù–ê–†–ò–ô 3: –ì–†–£–ü–ü–û–í–ê–Ø –¢–†–ï–ù–ò–†–û–í–ö–ê");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –≥—Ä—É–ø–ø–æ–≤—ã—Ö –±—Ä–æ–Ω–µ–π —Å –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –≥—Ä—É–ø–ø–æ–≤–æ–π —Ä–µ—Å—É—Ä—Å, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã 90 –º–∏–Ω, –ª–∏–º–∏—Ç 10 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤");

        // –®–ê–ì 1: –ü–æ–ª—É—á–∏—Ç—å –¥–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –¥–ª—è –≥—Ä—É–ø–ø–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏
        $this->info("\nüìÖ –®–ê–ì 1: –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –¥–ª—è –≥—Ä—É–ø–ø–æ–≤–æ–π —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏...");
        $slots = $this->getSlots($resourceId, '2024-01-17', 5);
        $this->info("   üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã: " . count($slots));

        // –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å –≥—Ä—É–ø–ø–æ–≤—É—é –±—Ä–æ–Ω—å —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º
        $this->info("\nüë• –®–ê–ì 2: –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä—É–ø–ø–æ–≤–æ–π –±—Ä–æ–Ω–∏ —Å –æ—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä–æ–º...");
        $groupBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-17 10:00:00',
            'end' => '2024-01-17 11:30:00',
            'booker' => [
                'name' => '–û—Ä–≥–∞–Ω–∏–∑–∞—Ç–æ—Ä —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∏',
                'email' => 'organizer@example.com',
                'type' => 'client',
                'metadata' => ['is_organizer' => true]
            ]
        ]);
        $this->checkStatus($groupBooking, 'confirmed', "–ì—Ä—É–ø–ø–æ–≤–∞—è –±—Ä–æ–Ω—å —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 3: –î–æ–±–∞–≤–∏—Ç—å –¥–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã—Ö —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –∫ –±—Ä–æ–Ω–∏
        $this->info("\nüë• –®–ê–ì 3: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –≥—Ä—É–ø–ø–æ–≤—É—é –±—Ä–æ–Ω—å...");
        $this->addParticipantsToBooking($groupBooking['id'], [
            ['name' => '–£—á–∞—Å—Ç–Ω–∏–∫ 1', 'email' => 'user1@example.com'],
            ['name' => '–£—á–∞—Å—Ç–Ω–∏–∫ 2', 'email' => 'user2@example.com'],
            ['name' => '–£—á–∞—Å—Ç–Ω–∏–∫ 3', 'email' => 'user3@example.com'],
        ]);

        // –®–ê–ì 4: –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 4: –ü–æ–ø—ã—Ç–∫–∞ –ø—Ä–µ–≤—ã—Å–∏—Ç—å –ª–∏–º–∏—Ç —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤...");
        try {
            $this->addParticipantsToBooking($groupBooking['id'], [
                ['name' => '–õ–∏—à–Ω–∏–π —É—á–∞—Å—Ç–Ω–∏–∫', 'email' => 'extra@example.com'],
            ]);
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        // –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–æ–≤–æ–π –±—Ä–æ–Ω–∏
        $this->info("\nüìÖ –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Å–ª–æ—Ç–æ–≤ –ø–æ—Å–ª–µ –≥—Ä—É–ø–ø–æ–≤–æ–π –±—Ä–æ–Ω–∏...");
        $updatedSlots = $this->getSlots($resourceId, '2024-01-17', 5);
        $this->info("   üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã –ø–æ—Å–ª–µ –±—Ä–æ–Ω–∏: " . count($updatedSlots));

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 3 –ó–ê–í–ï–†–®–ï–ù: –ì—Ä—É–ø–ø–æ–≤—ã–µ –±—Ä–æ–Ω–∏ –∏ –ª–∏–º–∏—Ç—ã —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 4: –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ - –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã + —Å—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è
     * ===========================================================================
     */
    private function runScenario4(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüíé –°–¶–ï–ù–ê–†–ò–ô 4: –î–û–†–û–ì–û–ï –û–ë–û–†–£–î–û–í–ê–ù–ò–ï");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Å—Ç—Ä–æ–≥–∏—Ö –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π –¥–ª—è —Ü–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: —Å—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã 120 –º–∏–Ω, –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω–æ");

        // –®–ê–ì 1: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ –±–µ–∑ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 1: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ –±–µ–∑ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏...");
        try {
            $this->createBooking([
                'resource_id' => $resourceId,
                'start' => now()->addMinutes(30)->format('Y-m-d H:i:s'),
                'end' => now()->addMinutes(150)->format('Y-m-d H:i:s'),
                'booker' => ['name' => '–¢–æ—Ä–æ–ø–ª–∏–≤—ã–π –∫–ª–∏–µ–Ω—Ç']
            ]);
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        // –®–ê–ì 2: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –±—Ä–æ–Ω—å —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è
        $this->info("\n‚è≥ –®–ê–ì 2: –ö–æ—Ä—Ä–µ–∫—Ç–Ω–∞—è –±—Ä–æ–Ω—å —Å –æ–∂–∏–¥–∞–Ω–∏–µ–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è...");
        $pendingBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-18 10:00:00',
            'end' => '2024-01-18 12:00:00',
            'booker' => ['name' => '–°–µ—Ä—å–µ–∑–Ω—ã–π –∫–ª–∏–µ–Ω—Ç', 'email' => 'serious@example.com']
        ]);
        $this->checkStatus($pendingBooking, 'pending', "–ë—Ä–æ–Ω—å –æ–∂–∏–¥–∞–µ—Ç –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏—è");

        // –®–ê–ì 3: –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        $this->info("\n‚ùå –®–ê–ì 3: –û—Ç–∫–ª–æ–Ω–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º...");
        $rejectedBooking = $this->cancelBooking($pendingBooking['id'], 'admin', '–û–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ –Ω–∞ –æ–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–∏');
        $this->checkStatus($rejectedBooking, 'cancelled_by_admin', "–ë—Ä–æ–Ω—å –æ—Ç–∫–ª–æ–Ω–µ–Ω–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º");

        // –®–ê–ì 4: –ë—Ä–æ–Ω—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å –æ–±—Ö–æ–¥–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π
        $this->info("\nüë®‚Äçüíº –®–ê–ì 4: –ë—Ä–æ–Ω—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º —Å –æ–±—Ö–æ–¥–æ–º –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π...");
        $adminBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => now()->addMinutes(60)->format('Y-m-d H:i:s'),
            'end' => now()->addMinutes(180)->format('Y-m-d H:i:s'),
            'is_admin' => true,
            'booker' => ['name' => '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'type' => 'admin']
        ]);
        $this->checkStatus($adminBooking, 'confirmed', "–ë—Ä–æ–Ω—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");

        // –®–ê–ì 5: –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 5: –ü–æ–ø—ã—Ç–∫–∞ –æ—Ç–º–µ–Ω—ã –≤ –ø–æ—Å–ª–µ–¥–Ω–∏–π –º–æ–º–µ–Ω—Ç...");
        try {
            $this->cancelBooking($adminBooking['id'], 'client', '–°—Ä–æ—á–Ω—ã–µ –æ–±—Å—Ç–æ—è—Ç–µ–ª—å—Å—Ç–≤–∞');
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 4 –ó–ê–í–ï–†–®–ï–ù: –°—Ç—Ä–æ–≥–∏–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è –¥–ª—è —Ü–µ–Ω–Ω—ã—Ö —Ä–µ—Å—É—Ä—Å–æ–≤ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 5: –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä - –ü–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –±—Ä–æ–Ω–∏ + —Ä–∞–∑–Ω—ã–µ —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏
     * ===========================================================================
     */
    private function runScenario5(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüè® –°–¶–ï–ù–ê–†–ò–ô 5: –ì–û–°–¢–ò–ù–ò–ß–ù–´–ô –ù–û–ú–ï–†");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã—Ö (–ø–µ—Ä–µ—Ö–æ–¥—è—â–∏—Ö) –±—Ä–æ–Ω–µ–π");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏–µ –±—Ä–æ–Ω–∏, –º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã–µ, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã 24 —á–∞—Å–∞");

        // –®–ê–ì 1: –ë—Ä–æ–Ω—å –Ω–∞ 3 –¥–Ω—è
        $this->info("\nüìÖ –®–ê–ì 1: –ë—Ä–æ–Ω—å –Ω–æ–º–µ—Ä–∞ –Ω–∞ 3 –¥–Ω—è...");
        $threeDayBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-20 14:00:00',
            'end' => '2024-01-23 12:00:00',
            'booker' => ['name' => '–ì–æ—Å—Ç—å –æ—Ç–µ–ª—è', 'email' => 'guest@example.com']
        ]);
        $this->checkStatus($threeDayBooking, 'confirmed', "–ë—Ä–æ–Ω—å –Ω–∞ 3 –¥–Ω—è —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 2: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ –≤ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –¥–∞—Ç—ã (–¥–æ–ª–∂–Ω–∞ –±—ã—Ç—å –æ—à–∏–±–∫–∞)
        $this->info("\n‚ùå –®–ê–ì 2: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ –≤ –ø–µ—Ä–µ—Å–µ–∫–∞—é—â–∏–µ—Å—è –¥–∞—Ç—ã...");
        try {
            $this->createBooking([
                'resource_id' => $resourceId,
                'start' => '2024-01-22 10:00:00', // –ü–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±—Ä–æ–Ω—å—é
                'end' => '2024-01-24 12:00:00',
                'booker' => ['name' => '–ö–æ–Ω—Ñ–ª–∏–∫—Ç–Ω—ã–π –≥–æ—Å—Ç—å']
            ]);
            $this->error("   üö® –ù–ï–û–ñ–ò–î–ê–ù–ù–û: –î–æ–ª–∂–Ω–æ –±—ã–ª–æ –±—ã—Ç—å –æ—à–∏–±–∫–æ–π!");
        } catch (\Exception $e) {
            $this->info("   ‚úÖ –û–∂–∏–¥–∞–µ–º–∞—è –æ—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        // –®–ê–ì 3: –ë—Ä–æ–Ω—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞
        $this->info("\n‚úÖ –®–ê–ì 3: –ë—Ä–æ–Ω—å —Å—Ä–∞–∑—É –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è –Ω–æ–º–µ—Ä–∞...");
        $nextBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-23 14:00:00', // –ü–æ—Å–ª–µ –ø—Ä–µ–¥—ã–¥—É—â–µ–π –±—Ä–æ–Ω–∏
            'end' => '2024-01-25 12:00:00',
            'booker' => ['name' => '–°–ª–µ–¥—É—é—â–∏–π –≥–æ—Å—Ç—å']
        ]);
        $this->checkStatus($nextBooking, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ—Å–ª–µ –æ—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç
        $this->info("\nüìÖ –®–ê–ì 4: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç...");
        $this->testDateRangeAvailability($resourceId);

        // –®–ê–ì 5: –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        $this->info("\nüîÑ –®–ê–ì 5: –ü–µ—Ä–µ–Ω–æ—Å –¥–ª–∏—Ç–µ–ª—å–Ω–æ–π –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º...");
        $rescheduled = $this->rescheduleBooking($threeDayBooking['id'],
            '2024-01-25 14:00:00', '2024-01-28 12:00:00', 'admin');
        $this->info("   ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–∞—è –±—Ä–æ–Ω—å –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞: {$rescheduled['start']} ‚Üí {$rescheduled['end']}");

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 5 –ó–ê–í–ï–†–®–ï–ù: –ú–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã–µ –±—Ä–æ–Ω–∏ —Ä–∞–±–æ—Ç–∞—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 6: –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π - –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä vs –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
     * ===========================================================================
     */
    private function runScenario6(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\n‚ö° –°–¶–ï–ù–ê–†–ò–ô 6: –≠–ö–°–¢–†–ï–ù–ù–´–ô –°–õ–£–ß–ê–ô");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–∞ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ –Ω–∞–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–º");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞, —ç–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ –æ—Ç–º–µ–Ω—ã, –ø–µ—Ä–µ–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ");

        // –®–ê–ì 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –æ–±—ã—á–Ω—É—é –±—Ä–æ–Ω—å
        $this->info("\nüë§ –®–ê–ì 1: –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å —Å–æ–∑–¥–∞–µ—Ç –æ–±—ã—á–Ω—É—é –±—Ä–æ–Ω—å...");
        $userBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-19 15:00:00',
            'end' => '2024-01-19 16:00:00',
            'booker' => ['name' => '–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å']
        ]);
        $this->checkStatus($userBooking, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 2: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –±—Ä–æ–Ω—å –ø–æ–≤–µ—Ä—Ö —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π
        $this->info("\nüë®‚Äçüíº –®–ê–ì 2: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä —Å–æ–∑–¥–∞–µ—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –±—Ä–æ–Ω—å...");
        $emergencyBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-19 15:00:00', // –¢–æ –∂–µ –≤—Ä–µ–º—è —á—Ç–æ –∏ —É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
            'end' => '2024-01-19 16:00:00',
            'is_admin' => true,
            'booker' => ['name' => '–ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä', 'type' => 'admin']
        ]);
        $this->checkStatus($emergencyBooking, 'confirmed', "–≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –±—Ä–æ–Ω—å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –±—Ä–æ–Ω—å –±—ã–ª–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–µ–Ω–∞
        $this->info("\nüîç –®–ê–ì 3: –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –±—Ä–æ–Ω–∏...");
        $this->line("   –¶–µ–ª—å: –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∞—è –±—Ä–æ–Ω—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–µ–Ω–∞");
        $updatedUserBooking = $this->getBooking($userBooking['id']);
        $this->checkStatus($updatedUserBooking, 'cancelled_by_admin', "–ë—Ä–æ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ—Ç–º–µ–Ω–µ–Ω–∞");

        // –®–ê–ì 4: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –±—Ä–æ–Ω—å
        $this->info("\nüîÑ –®–ê–ì 4: –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –ø–µ—Ä–µ–Ω–æ—Å–∏—Ç —ç–∫—Å—Ç—Ä–µ–Ω–Ω—É—é –±—Ä–æ–Ω—å...");
        $rescheduledEmergency = $this->rescheduleBooking($emergencyBooking['id'],
            '2024-01-19 16:00:00', '2024-01-19 17:00:00', 'admin');
        $this->info("   ‚úÖ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –±—Ä–æ–Ω—å –ø–µ—Ä–µ–Ω–µ—Å–µ–Ω–∞: {$rescheduledEmergency['start']} ‚Üí {$rescheduledEmergency['end']}");

        // –®–ê–ì 5: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –±—Ä–æ–Ω–∏ –Ω–∞ –æ—Å–≤–æ–±–æ–¥–∏–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
        $this->info("\n‚úÖ –®–ê–ì 5: –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–æ–π –±—Ä–æ–Ω–∏...");
        $restoredBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-19 15:00:00', // –û—Å–≤–æ–±–æ–¥–∏–≤—à–µ–µ—Å—è –≤—Ä–µ–º—è
            'end' => '2024-01-19 16:00:00',
            'booker' => ['name' => '–û–±—ã—á–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å']
        ]);
        $this->checkStatus($restoredBooking, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∞");

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 6 –ó–ê–í–ï–†–®–ï–ù: –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 7: –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã - –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º–∏
     * ===========================================================================
     */
    private function runScenario7(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüíÖ –°–¶–ï–ù–ê–†–ò–ô 7: –°–ê–õ–û–ù –ö–†–ê–°–û–¢–´");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–º–∏ –¥–Ω—è–º–∏ –∏ –≤—ã—Ö–æ–¥–Ω—ã–º–∏");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –°—Ç–∞—Ç–∏—á–µ—Å–∫–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º–∏, —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã");

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –¥–Ω–µ–π: —Ä–∞–±–æ—á–∏–µ, –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–µ, –≤—ã—Ö–æ–¥–Ω—ã–µ
        $testDates = [
            '2024-01-15' => ['type' => 'working', 'desc' => '–†–∞–±–æ—á–∏–π –ø–æ–Ω–µ–¥–µ–ª—å–Ω–∏–∫'],
            '2024-01-01' => ['type' => 'holiday', 'desc' => '–ü—Ä–∞–∑–¥–Ω–∏–∫ (–ù–æ–≤—ã–π –≥–æ–¥)'],
            '2024-01-14' => ['type' => 'weekend', 'desc' => '–í–æ—Å–∫—Ä–µ—Å–µ–Ω—å–µ (–≤—ã—Ö–æ–¥–Ω–æ–π)'],
            '2024-03-08' => ['type' => 'holiday', 'desc' => '–ü—Ä–∞–∑–¥–Ω–∏–∫ (8 –º–∞—Ä—Ç–∞)'],
            '2024-01-16' => ['type' => 'working', 'desc' => '–†–∞–±–æ—á–∏–π –≤—Ç–æ—Ä–Ω–∏–∫']
        ];

        foreach ($testDates as $date => $info) {
            $this->info("\nüìÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ {$info['desc']} ({$date})...");
            $slots = $this->getSlots($resourceId, $date, 3);

            if ($info['type'] === 'working' && count($slots) > 0) {
                $this->info("   ‚úÖ {$info['desc']}: " . count($slots) . " —Å–ª–æ—Ç–æ–≤ –¥–æ—Å—Ç—É–ø–Ω–æ");
                $this->line("      üïí –ü–µ—Ä–≤—ã–µ —Å–ª–æ—Ç—ã: " . implode(', ', array_slice($slots, 0, 2)));
            } elseif ($info['type'] === 'working') {
                $this->error("   ‚ùå {$info['desc']}: –ù–µ—Ç –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ (–ù–ï–û–ñ–ò–î–ê–ù–ù–û)");
            } else {
                $this->info("   ‚úÖ {$info['desc']}: –ù–µ—Ç —Å–ª–æ—Ç–æ–≤ (–æ–∂–∏–¥–∞–µ–º–æ)");
            }
        }

        // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ –≤ —Ä–∞–±–æ—á–∏–π –¥–µ–Ω—å
        $this->info("\n‚è∞ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤...");
        $slotsMonday = $this->getSlots($resourceId, '2024-01-15', 10);
        $hasBreakGap = false;

        foreach ($slotsMonday as $slot) {
            if (strpos($slot, '13:00') !== false) {
                $hasBreakGap = true;
                break;
            }
        }

        if ($hasBreakGap) {
            $this->info("   ‚úÖ –ü–µ—Ä–µ—Ä—ã–≤—ã –ø—Ä–∞–≤–∏–ª—å–Ω–æ –∏—Å–∫–ª—é—á–µ–Ω—ã –∏–∑ —Å–ª–æ—Ç–æ–≤");
        } else {
            $this->error("   ‚ùå –ü–µ—Ä–µ—Ä—ã–≤—ã –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –æ–±—Ä–∞–±–æ—Ç–∞–Ω—ã");
        }

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 7 –ó–ê–í–ï–†–®–ï–ù: –û–±—Ä–∞–±–æ—Ç–∫–∞ –ø—Ä–∞–∑–¥–Ω–∏–∫–æ–≤ –∏ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    /**
     * ===========================================================================
     * –°–¶–ï–ù–ê–†–ò–ô 8: –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä - –°–º–µ—à–∞–Ω–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ + –ø–µ—Ä–µ—Ä—ã–≤—ã
     * ===========================================================================
     */
    private function runScenario8(array $setupData): void
    {
        $resourceId = $setupData['resource_id'];

        $this->info("\nüè¢ –°–¶–ï–ù–ê–†–ò–ô 8: –ë–ò–ó–ù–ï–°-–¶–ï–ù–¢–†");
        $this->line("üéØ –¶–µ–ª—å: –î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏—è —Ä–∞–±–æ—Ç—ã —Å–æ —Å–ª–æ–∂–Ω—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏");
        $this->line("üìã –ü–∞—Ä–∞–º–µ—Ç—Ä—ã: –°–ª–æ–∂–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏, –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã");

        // –®–ê–ì 1: –ü–æ–ª—É—á–∏—Ç—å —Å–ª–æ—Ç—ã –≤ –¥–µ–Ω—å —Å–æ —Å–ª–æ–∂–Ω—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
        $this->info("\nüìÖ –®–ê–ì 1: –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ª–æ—Ç–æ–≤ –≤ –¥–µ–Ω—å —Å–æ —Å–ª–æ–∂–Ω—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º...");
        $slots = $this->getSlots($resourceId, '2024-01-22', 10);
        $this->info("   üìä –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–ª–æ—Ç—ã: " . count($slots));
        $this->info("   üïí –ü—Ä–∏–º–µ—Ä—ã —Å–ª–æ—Ç–æ–≤: " . implode(', ', array_slice($slots, 0, 5)));

        // –®–ê–ì 2: –°–æ–∑–¥–∞—Ç—å –±—Ä–æ–Ω—å –º–µ–∂–¥—É –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏
        $this->info("\n‚úÖ –®–ê–ì 2: –°–æ–∑–¥–∞–Ω–∏–µ –±—Ä–æ–Ω–∏ –º–µ–∂–¥—É –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏...");
        $betweenBreaksBooking = $this->createBooking([
            'resource_id' => $resourceId,
            'start' => '2024-01-22 13:30:00', // –ú–µ–∂–¥—É –æ–±–µ–¥–æ–º –∏ –∫–æ—Ñ–µ-–±—Ä–µ–π–∫–æ–º
            'end' => '2024-01-22 15:00:00',
            'booker' => ['name' => '–ë–∏–∑–Ω–µ—Å-–≤—Å—Ç—Ä–µ—á–∞']
        ]);
        $this->checkStatus($betweenBreaksBooking, 'pending', "–ë—Ä–æ–Ω—å –º–µ–∂–¥—É –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏ —Å–æ–∑–¥–∞–Ω–∞");

        // –®–ê–ì 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º
        $this->info("\n‚úÖ –®–ê–ì 3: –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º...");
        $confirmedBooking = $this->confirmBooking($betweenBreaksBooking['id']);
        $this->checkStatus($confirmedBooking, 'confirmed', "–ë—Ä–æ–Ω—å –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∞");

        // –®–ê–ì 4: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤
        $this->info("\nüîç –®–ê–ì 4: –ü–æ–ø—ã—Ç–∫–∞ –±—Ä–æ–Ω–∏ —á–µ—Ä–µ–∑ –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤...");
        try {
            $crossBreaksBooking = $this->createBooking([
                'resource_id' => $resourceId,
                'start' => '2024-01-22 11:30:00', // –î–æ –æ–±–µ–¥–∞
                'end' => '2024-01-22 17:00:00',   // –ü–æ—Å–ª–µ –∫–æ—Ñ–µ-–±—Ä–µ–π–∫–∞
                'booker' => ['name' => '–î–ª–∏—Ç–µ–ª—å–Ω–∞—è –≤—Å—Ç—Ä–µ—á–∞']
            ]);
            $this->info("   ‚úÖ –î–ª–∏—Ç–µ–ª—å–Ω–∞—è –±—Ä–æ–Ω—å —Å–æ–∑–¥–∞–Ω–∞: {$crossBreaksBooking['start']} - {$crossBreaksBooking['end']}");
        } catch (\Exception $e) {
            $this->info("   ‚ùå –û—à–∏–±–∫–∞: {$e->getMessage()}");
        }

        // –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –¥–µ–Ω—å
        $this->info("\nüéÑ –®–ê–ì 5: –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤ –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –¥–µ–Ω—å...");
        $holidaySlots = $this->getSlots($resourceId, '2024-01-01', 5); // –ù–æ–≤—ã–π –≥–æ–¥
        if (count($holidaySlots) === 0) {
            $this->info("   ‚úÖ –í –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –¥–µ–Ω—å —Å–ª–æ—Ç–æ–≤ –Ω–µ—Ç (–æ–∂–∏–¥–∞–µ–º–æ)");
        } else {
            $this->error("   ‚ùå –í –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã–π –¥–µ–Ω—å –µ—Å—Ç—å —Å–ª–æ—Ç—ã (–ù–ï–û–ñ–ò–î–ê–ù–ù–û)");
        }

        $this->info("\nüéâ –°–¶–ï–ù–ê–†–ò–ô 8 –ó–ê–í–ï–†–®–ï–ù: –°–ª–æ–∂–Ω–æ–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ —Å –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏ —Ä–∞–±–æ—Ç–∞–µ—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ!");
    }

    // ===========================================================================
    // –í–°–ü–û–ú–û–ì–ê–¢–ï–õ–¨–ù–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–Ø
    // ===========================================================================

    /**
     * –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–≥—Ä–∞–Ω–∏—á–Ω—ã—Ö —Å–ª—É—á–∞–µ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ä—ã–≤–æ–≤
     */
    private function testBoundaryCases(int $resourceId): void
    {
        $this->line("   üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –≤—Ä–µ–º–µ–Ω–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –æ—Ç–Ω–æ—Å–∏—Ç–µ–ª—å–Ω–æ –ø–µ—Ä–µ—Ä—ã–≤–∞:");

        $testCases = [
            ['start' => '2024-01-15 13:00:00', 'end' => '2024-01-15 14:00:00', 'expected' => false, 'reason' => '–ü–æ–ª–Ω–æ—Å—Ç—å—é –≤–Ω—É—Ç—Ä–∏ –ø–µ—Ä–µ—Ä—ã–≤–∞'],
            ['start' => '2024-01-15 12:30:00', 'end' => '2024-01-15 13:30:00', 'expected' => false, 'reason' => '–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –¥–æ, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è –ø–µ—Ä–µ—Ä—ã–≤–∞'],
            ['start' => '2024-01-15 13:45:00', 'end' => '2024-01-15 14:45:00', 'expected' => false, 'reason' => '–ù–∞—á–∏–Ω–∞–µ—Ç—Å—è –≤–æ –≤—Ä–µ–º—è, –∑–∞–∫–∞–Ω—á–∏–≤–∞–µ—Ç—Å—è –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞'],
            ['start' => '2024-01-15 14:15:00', 'end' => '2024-01-15 15:15:00', 'expected' => true, 'reason' => '–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å–ª–æ—Ç –ø–æ—Å–ª–µ –ø–µ—Ä–µ—Ä—ã–≤–∞'],
            ['start' => '2024-01-15 11:00:00', 'end' => '2024-01-15 12:00:00', 'expected' => true, 'reason' => '–ö–æ—Ä—Ä–µ–∫—Ç–Ω—ã–π —Å–ª–æ—Ç –¥–æ –ø–µ—Ä–µ—Ä—ã–≤–∞'],
        ];

        foreach ($testCases as $case) {
            try {
                $available = $this->isRangeAvailable($resourceId, $case['start'], $case['end']);
                $status = $available === $case['expected'] ? '‚úÖ' : '‚ùå';
                $this->info("   {$status} {$case['reason']}: " . ($available ? '–¥–æ—Å—Ç—É–ø–µ–Ω' : '–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω'));
            } catch (\Exception $e) {
                $this->info("   ‚ùå {$case['reason']}: –æ—à–∏–±–∫–∞ - {$e->getMessage()}");
            }
        }
    }

    /**
     * –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ –¥–∞—Ç –¥–ª—è –º–Ω–æ–≥–æ–¥–Ω–µ–≤–Ω—ã—Ö –±—Ä–æ–Ω–µ–π
     */
    private function testDateRangeAvailability(int $resourceId): void
    {
        $this->line("   üéØ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ —Ä–∞–∑–ª–∏—á–Ω—ã—Ö –¥–∏–∞–ø–∞–∑–æ–Ω–æ–≤ –¥–∞—Ç:");

        $testRanges = [
            ['start' => '2024-01-21 14:00:00', 'end' => '2024-01-22 12:00:00', 'expected' => false, 'reason' => '–ü–µ—Ä–µ—Å–µ–∫–∞–µ—Ç—Å—è —Å —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±—Ä–æ–Ω—å—é'],
            ['start' => '2024-01-19 14:00:00', 'end' => '2024-01-20 12:00:00', 'expected' => true, 'reason' => '–î–æ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±—Ä–æ–Ω–∏'],
            ['start' => '2024-01-25 14:00:00', 'end' => '2024-01-26 12:00:00', 'expected' => true, 'reason' => '–ü–æ—Å–ª–µ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–π –±—Ä–æ–Ω–∏'],
        ];

        foreach ($testRanges as $range) {
            $available = $this->isRangeAvailable($resourceId, $range['start'], $range['end']);
            $status = $available === $range['expected'] ? '‚úÖ' : '‚ùå';
            $this->info("   {$status} {$range['reason']}: " . ($available ? '–¥–æ—Å—Ç—É–ø–µ–Ω' : '–Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω'));
        }
    }

    /**
     * –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –≥—Ä—É–ø–ø–æ–≤—É—é –±—Ä–æ–Ω—å (—Å–∏–º—É–ª—è—Ü–∏—è)
     */
    private function addParticipantsToBooking(int $bookingId, array $participants): void
    {
        $this->line("   üë• –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤ –≤ –±—Ä–æ–Ω—å {$bookingId}:");

        foreach ($participants as $participant) {
            // –í —Ä–µ–∞–ª—å–Ω–æ–π —Å–∏—Å—Ç–µ–º–µ –∑–¥–µ—Å—å –±—ã–ª –±—ã –≤—ã–∑–æ–≤ API –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
            $this->info("      üë§ –î–æ–±–∞–≤–ª–µ–Ω —É—á–∞—Å—Ç–Ω–∏–∫: {$participant['name']}");
        }
        $this->info("   ‚úÖ –£—á–∞—Å—Ç–Ω–∏–∫–∏ –¥–æ–±–∞–≤–ª–µ–Ω—ã –≤ –±—Ä–æ–Ω—å {$bookingId}");
    }

    // ===========================================================================
    // –û–°–ù–û–í–ù–´–ï –ú–ï–¢–û–î–´ –î–õ–Ø –†–ê–ë–û–¢–´ –° –ë–†–û–ù–ò–†–û–í–ê–ù–ò–Ø–ú–ò (–ü–†–Ø–ú–´–ï –í–´–ó–û–í–´)
    // ===========================================================================

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–Ω—ã—Ö —Å–ª–æ—Ç–æ–≤ –¥–ª—è —Ä–µ—Å—É—Ä—Å–∞
     */
    private function getSlots(int $resourceId, string $date, int $count): array
    {
        $request = new GetSlotsRequest();
        $request->merge([
            'date' => $date,
            'count' => $count,
            'only_today' => true
        ]);

        $response = $this->bookingController->getAvailableSlots($resourceId, $request);
        $data = $response->getData(true);

        return array_map(function($slot) {
            return $slot['start'] . '-' . $slot['end'];
        }, $data['data'] ?? []);
    }

    /**
     * –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–π –±—Ä–æ–Ω–∏
     */
    private function createBooking(array $data): array
    {
        $request = new CreateBookingRequest();
        $request->merge($data);

        $response = $this->bookingController->createBooking($request);
        $responseData = $response->getData(true);

        if (isset($responseData['data'])) {
            return $responseData['data'];
        }

        throw new \Exception($responseData['error'] ?? '–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –±—Ä–æ–Ω–∏');
    }

    /**
     * –ü–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ –±—Ä–æ–Ω–∏
     */
    private function confirmBooking(int $bookingId): array
    {
        $response = $this->bookingController->confirmBooking($bookingId);
        $responseData = $response->getData(true);

        return $responseData['data'];
    }

    /**
     * –û—Ç–º–µ–Ω–∞ –±—Ä–æ–Ω–∏
     */
    private function cancelBooking(int $bookingId, string $cancelledBy, ?string $reason = null): array
    {
        $request = new CancelBookingRequest();
        $request->merge([
            'cancelled_by' => $cancelledBy,
            'reason' => $reason
        ]);

        $response = $this->bookingController->cancelBooking($bookingId, $request);
        $responseData = $response->getData(true);

        return $responseData['data'];
    }

    /**
     * –ü–µ—Ä–µ–Ω–æ—Å –±—Ä–æ–Ω–∏
     */
    private function rescheduleBooking(int $bookingId, string $newStart, string $newEnd, string $requestedBy): array
    {
        $request = new RescheduleBookingRequest();
        $request->merge([
            'new_start' => $newStart,
            'new_end' => $newEnd,
            'requested_by' => $requestedBy
        ]);

        $response = $this->bookingController->rescheduleBooking($bookingId, $request);
        $responseData = $response->getData(true);

        return $responseData['data'];
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä–∫–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç–∏ –≤—Ä–µ–º–µ–Ω–Ω–æ–≥–æ –¥–∏–∞–ø–∞–∑–æ–Ω–∞
     */
    private function isRangeAvailable(int $resourceId, string $start, string $end): bool
    {
        $request = new CheckAvailabilityRequest();
        $request->merge([
            'resource_id' => $resourceId,
            'start' => $start,
            'end' => $end
        ]);

        $response = $this->bookingController->checkSlotAvailability($request);
        $data = $response->getData(true);

        return $data['available'] ?? false;
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –±—Ä–æ–Ω–∏ –ø–æ ID
     */
    private function getBooking(int $bookingId): array
    {
        // –î–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –±—Ä–æ–Ω–∏ —Å–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–π Request
        $request = new Request();

        // –í —Ä–µ–∞–ª—å–Ω–æ–º –∫–æ–Ω—Ç—Ä–æ–ª–ª–µ—Ä–µ –º–æ–∂–µ—Ç –±—ã—Ç—å –º–µ—Ç–æ–¥ show, –Ω–æ –µ—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç,
        // –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä—è–º–æ–π –∑–∞–ø—Ä–æ—Å –∫ –º–æ–¥–µ–ª–∏
        try {
            $booking = \App\Models\Booking::with(['resource', 'bookers'])->findOrFail($bookingId);
            return [
                'id' => $booking->id,
                'resource_id' => $booking->resource_id,
                'start' => $booking->start,
                'end' => $booking->end,
                'status' => $booking->status,
                'reason' => $booking->reason,
                'resource' => $booking->resource,
                'bookers' => $booking->bookers
            ];
        } catch (\Exception $e) {
            throw new \Exception('–ë—Ä–æ–Ω—å –Ω–µ –Ω–∞–π–¥–µ–Ω–∞: ' . $e->getMessage());
        }
    }

    /**
     * –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞ –±—Ä–æ–Ω–∏
     */
    private function checkStatus(array $booking, string $expectedStatus, string $message): void
    {
        if ($booking['status'] === $expectedStatus) {
            $this->info("   ‚úÖ {$message}: —Å—Ç–∞—Ç—É—Å = {$booking['status']}");
        } else {
            $this->error("   ‚ùå {$message}: –æ–∂–∏–¥–∞–ª—Å—è {$expectedStatus}, –ø–æ–ª—É—á–µ–Ω {$booking['status']}");
        }
    }

    // ===========================================================================
    // –ú–ï–¢–û–î–´ –î–õ–Ø –ü–û–õ–£–ß–ï–ù–ò–Ø –î–ê–ù–ù–´–• –°–¶–ï–ù–ê–†–ò–ï–í (–±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π)
    // ===========================================================================

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function getTimetableForScenario(int $scenarioId): array
    {
        $timetables = [
            1 => [ // –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è (—É—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π)
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']] // –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤
                        ],
                        'tuesday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'wednesday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'thursday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'friday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ]
                    ]
                ]
            ],
            2 => [ // –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'tuesday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'wednesday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'thursday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'friday' => ['working_hours' => ['start' => '08:00', 'end' => '18:00']],
                    ]
                ]
            ],
            3 => [ // –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => ['working_hours' => ['start' => '07:00', 'end' => '22:00']],
                        'tuesday' => ['working_hours' => ['start' => '07:00', 'end' => '22:00']],
                        'wednesday' => ['working_hours' => ['start' => '07:00', 'end' => '22:00']],
                        'thursday' => ['working_hours' => ['start' => '07:00', 'end' => '22:00']],
                        'friday' => ['working_hours' => ['start' => '07:00', 'end' => '22:00']],
                        'saturday' => ['working_hours' => ['start' => '09:00', 'end' => '18:00']],
                        'sunday' => ['working_hours' => ['start' => '09:00', 'end' => '16:00']],
                    ]
                ]
            ],
            4 => [ // –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '12:30', 'end' => '13:30']] // –û–±–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤
                        ],
                        'tuesday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '12:30', 'end' => '13:30']]
                        ],
                        'wednesday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '12:30', 'end' => '13:30']]
                        ],
                        'thursday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '12:30', 'end' => '13:30']]
                        ],
                        'friday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '18:00'],
                            'breaks' => [['start' => '12:30', 'end' => '13:30']]
                        ],
                    ]
                ]
            ],
            5 => [ // –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'tuesday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'wednesday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'thursday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'friday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'saturday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                        'sunday' => ['working_hours' => ['start' => '00:00', 'end' => '23:59']],
                    ]
                ]
            ],
            6 => [ // –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'tuesday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'wednesday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'thursday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                        'friday' => ['working_hours' => ['start' => '08:00', 'end' => '20:00']],
                    ]
                ]
            ],
            7 => [ // –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã —Å –ø—Ä–∞–∑–¥–Ω–∏–∫–∞–º–∏
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '20:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']] // –ù–µ—Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤
                        ],
                        'tuesday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '20:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'wednesday' => [
                            'working_hours' => ['start' => '10:00', 'end' => '18:00'],
                            'breaks' => [['start' => '14:00', 'end' => '15:00']]
                        ],
                        'thursday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '20:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'friday' => [
                            'working_hours' => ['start' => '09:00', 'end' => '21:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ],
                        'saturday' => [
                            'working_hours' => ['start' => '10:00', 'end' => '16:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ]
                    ],
                    'holidays' => ['01-01', '01-02', '01-07', '03-08', '05-01', '05-09']
                ]
            ],
            8 => [ // –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä —Å–æ —Å–ª–æ–∂–Ω—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º
                'type' => 'static',
                'schedule' => [
                    'days' => [
                        'monday' => [
                            'working_hours' => ['start' => '08:00', 'end' => '22:00'],
                            'breaks' => [
                                ['start' => '12:15', 'end' => '13:15'], // –û–±–µ–¥–µ–Ω–Ω—ã–π –ø–µ—Ä–µ—Ä—ã–≤
                                ['start' => '16:00', 'end' => '16:30']  // –ö–æ—Ñ–µ-–±—Ä–µ–π–∫
                            ]
                        ],
                        'tuesday' => [
                            'working_hours' => ['start' => '08:00', 'end' => '22:00'],
                            'breaks' => [
                                ['start' => '12:15', 'end' => '13:15'],
                                ['start' => '16:00', 'end' => '16:30']
                            ]
                        ],
                        'wednesday' => [
                            'working_hours' => ['start' => '08:00', 'end' => '22:00'],
                            'breaks' => [
                                ['start' => '12:15', 'end' => '13:15'],
                                ['start' => '16:00', 'end' => '16:30']
                            ]
                        ],
                        'thursday' => [
                            'working_hours' => ['start' => '08:00', 'end' => '22:00'],
                            'breaks' => [
                                ['start' => '12:15', 'end' => '13:15'],
                                ['start' => '16:00', 'end' => '16:30']
                            ]
                        ],
                        'friday' => [
                            'working_hours' => ['start' => '08:00', 'end' => '20:00'],
                            'breaks' => [
                                ['start' => '12:15', 'end' => '13:15'],
                                ['start' => '15:00', 'end' => '15:30']
                            ]
                        ],
                        'saturday' => [
                            'working_hours' => ['start' => '10:00', 'end' => '16:00'],
                            'breaks' => [['start' => '13:15', 'end' => '14:15']]
                        ]
                    ],
                    'holidays' => ['01-01', '01-02', '01-07', '02-23', '03-08', '05-01', '05-09', '06-12', '11-04']
                ]
            ]
        ];

        return $timetables[$scenarioId] ?? $timetables[1];
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–µ—Å—É—Ä—Å–∞ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function getResourceConfigForScenario(int $scenarioId): array
    {
        $configs = [
            1 => [ // –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è (—É—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π)
                'require_confirmation' => false,           // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 60,            // –°–ª–æ—Ç—ã –ø–æ 60 –º–∏–Ω—É—Ç
                'slot_strategy' => 'fixed',               // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 60,                 // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∏–Ω–∏–º—É–º –∑–∞ 60 –º–∏–Ω
                'cancellation_time' => 120,               // –û—Ç–º–µ–Ω–∞ –≤–æ–∑–º–æ–∂–Ω–∞ –∑–∞ 120 –º–∏–Ω
                'reschedule_time' => 240,                 // –ü–µ—Ä–µ–Ω–æ—Å –≤–æ–∑–º–æ–∂–µ–Ω –∑–∞ 240 –º–∏–Ω
                'reminder_time' => 1440                   // –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞
            ],
            2 => [ // –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è
                'require_confirmation' => true,           // –†—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 30,            // –°–ª–æ—Ç—ã –ø–æ 30 –º–∏–Ω—É—Ç
                'slot_strategy' => 'dinamic',             // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 1440,               // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞
                'cancellation_time' => 720,               // –û—Ç–º–µ–Ω–∞ –∑–∞ 12 —á–∞—Å–æ–≤
                'reschedule_time' => 1440                 // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 24 —á–∞—Å–∞
            ],
            3 => [ // –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞
                'require_confirmation' => false,          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 90,            // –°–ª–æ—Ç—ã –ø–æ 90 –º–∏–Ω—É—Ç
                'slot_strategy' => 'fixed',               // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
                'max_participants' => 10,                 // –ú–∞–∫—Å–∏–º—É–º 10 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                'min_advance_time' => 60,                 // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 60 –º–∏–Ω
                'cancellation_time' => 180,               // –û—Ç–º–µ–Ω–∞ –∑–∞ 3 —á–∞—Å–∞
                'reschedule_time' => 360                  // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 6 —á–∞—Å–æ–≤
            ],
            4 => [ // –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ
                'require_confirmation' => true,           // –û–±—è–∑–∞—Ç–µ–ª—å–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 120,           // –°–ª–æ—Ç—ã –ø–æ 120 –º–∏–Ω—É—Ç
                'slot_strategy' => 'dinamic',             // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 2880,               // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 48 —á–∞—Å–æ–≤
                'cancellation_time' => 4320,              // –û—Ç–º–µ–Ω–∞ –∑–∞ 72 —á–∞—Å–∞
                'reschedule_time' => 5760,                // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 96 —á–∞—Å–æ–≤
                'reminder_time' => 1440                   // –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞
            ],
            5 => [ // –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä
                'require_confirmation' => false,          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 1440,          // –°–ª–æ—Ç—ã –ø–æ 24 —á–∞—Å–∞
                'slot_strategy' => 'fixed',               // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 0,                  // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
                'cancellation_time' => 10080,             // –û—Ç–º–µ–Ω–∞ –∑–∞ 7 –¥–Ω–µ–π
                'reschedule_time' => 10080                // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 7 –¥–Ω–µ–π
            ],
            6 => [ // –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Å–ª—É—á–∞–π
                'require_confirmation' => true,           // –†—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 60,            // –°–ª–æ—Ç—ã –ø–æ 60 –º–∏–Ω—É—Ç
                'slot_strategy' => 'dinamic',             // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 0,                  // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
                'cancellation_time' => 0,                 // –û—Ç–º–µ–Ω–∞ –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
                'reschedule_time' => 0                    // –ü–µ—Ä–µ–Ω–æ—Å –≤ –ª—é–±–æ–µ –≤—Ä–µ–º—è
            ],
            7 => [ // –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã
                'require_confirmation' => false,          // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 60,            // –°–ª–æ—Ç—ã –ø–æ 60 –º–∏–Ω—É—Ç
                'slot_strategy' => 'fixed',               // –§–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–ª–æ—Ç—ã
                'min_advance_time' => 120,                // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 2 —á–∞—Å–∞
                'cancellation_time' => 180,               // –û—Ç–º–µ–Ω–∞ –∑–∞ 3 —á–∞—Å–∞
                'reschedule_time' => 360,                 // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 6 —á–∞—Å–æ–≤
                'reminder_time' => 1440                   // –ù–∞–ø–æ–º–∏–Ω–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞
            ],
            8 => [ // –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä
                'require_confirmation' => true,           // –†—É—á–Ω–æ–µ –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ
                'slot_duration_minutes' => 60,            // –°–ª–æ—Ç—ã –ø–æ 60 –º–∏–Ω—É—Ç
                'slot_strategy' => 'dinamic',             // –î–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ —Å–ª–æ—Ç—ã
                'max_participants' => 20,                 // –ú–∞–∫—Å–∏–º—É–º 20 —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤
                'min_advance_time' => 1440,               // –ë—Ä–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞ 24 —á–∞—Å–∞
                'cancellation_time' => 720,               // –û—Ç–º–µ–Ω–∞ –∑–∞ 12 —á–∞—Å–æ–≤
                'reschedule_time' => 1440                 // –ü–µ—Ä–µ–Ω–æ—Å –∑–∞ 24 —á–∞—Å–∞
            ]
        ];

        return $configs[$scenarioId] ?? $configs[1];
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø–∏—Å–∞–Ω–∏—è —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function getScenarioDescription(int $scenarioId): string
    {
        $descriptions = [
            1 => "–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä—Å–∫–∞—è —É—Å–ª—É–≥–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–ª–æ—Ç–∞–º–∏ –∏ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º (—É—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π —Å –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏)",
            2 => "–ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Å–ª–æ—Ç–∞–º–∏ –∏ —Ä—É—á–Ω—ã–º –ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ–º",
            3 => "–ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞ —Å —Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–º–∏ —Å–ª–æ—Ç–∞–º–∏ –∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ–º —É—á–∞—Å—Ç–Ω–∏–∫–æ–≤",
            4 => "–î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ —Å –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–º–∏ —Å–ª–æ—Ç–∞–º–∏ –∏ —Å—Ç—Ä–æ–≥–∏–º–∏ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è–º–∏",
            5 => "–ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä —Å –ø–µ—Ä–µ—Ö–æ–¥—è—â–∏–º–∏ –±—Ä–æ–Ω—è–º–∏ –Ω–∞ –Ω–µ—Å–∫–æ–ª—å–∫–æ –¥–Ω–µ–π",
            6 => "–≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–µ —Å–ª—É—á–∞–∏ —Å –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç–æ–º –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞",
            7 => "–°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã —Å–æ —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏ —É—á–µ—Ç–æ–º –ø—Ä–∞–∑–¥–Ω–∏—á–Ω—ã—Ö –¥–Ω–µ–π",
            8 => "–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä —Å–æ —Å–ª–æ–∂–Ω—ã–º —Ä–∞—Å–ø–∏—Å–∞–Ω–∏–µ–º –∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–º–∏ –ø–µ—Ä–µ—Ä—ã–≤–∞–º–∏"
        ];

        return $descriptions[$scenarioId] ?? "–î–µ–º–æ–Ω—Å—Ç—Ä–∞—Ü–∏–æ–Ω–Ω—ã–π —Å—Ü–µ–Ω–∞—Ä–∏–π {$scenarioId}";
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–º–µ–Ω–∏ —Ä–µ—Å—É—Ä—Å–∞ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function getResourceName(int $scenarioId): string
    {
        $names = [
            1 => "üíà –ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä (—É—Å–ª–æ–∂–Ω–µ–Ω–Ω—ã–π)",
            2 => "üè¢ –ü–µ—Ä–µ–≥–æ–≤–æ—Ä–Ω–∞—è –∫–æ–º–Ω–∞—Ç–∞",
            3 => "üèãÔ∏è –ì—Ä—É–ø–ø–æ–≤–∞—è —Ç—Ä–µ–Ω–∏—Ä–æ–≤–∫–∞",
            4 => "üíé –î–æ—Ä–æ–≥–æ–µ –æ–±–æ—Ä—É–¥–æ–≤–∞–Ω–∏–µ",
            5 => "üè® –ì–æ—Å—Ç–∏–Ω–∏—á–Ω—ã–π –Ω–æ–º–µ—Ä",
            6 => "‚ö° –≠–∫—Å—Ç—Ä–µ–Ω–Ω—ã–π —Ä–µ—Å—É—Ä—Å",
            7 => "üíÖ –°–∞–ª–æ–Ω –∫—Ä–∞—Å–æ—Ç—ã",
            8 => "üè¢ –ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä"
        ];

        return $names[$scenarioId] ?? "–†–µ—Å—É—Ä—Å {$scenarioId}";
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –æ–ø—Ü–∏–π —Ä–µ—Å—É—Ä—Å–∞ –¥–ª—è —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function getResourceOptionsForScenario(int $scenarioId): array
    {
        $options = [
            1 => ['specialization' => '–ü–∞—Ä–∏–∫–º–∞—Ö–µ—Ä', 'experience' => '5 –ª–µ—Ç'],
            2 => ['location' => '–≠—Ç–∞–∂ 3', 'capacity' => 8, 'equipment' => ['projector', 'whiteboard']],
            3 => ['location' => '–ó–∞–ª –ê', 'trainer' => '–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤', 'type' => '–ô–æ–≥–∞'],
            4 => ['name' => '3D –ø—Ä–∏–Ω—Ç–µ—Ä', 'model' => 'Ultimaker S5', 'value' => '250000 —Ä—É–±'],
            5 => ['room_number' => '404', 'type' => '–°—Ç–∞–Ω–¥–∞—Ä—Ç', 'beds' => 2],
            6 => ['priority' => 'high', 'emergency_contact' => '+7-XXX-XXX-XX-XX'],
            7 => ['specialization' => '–ö–æ—Å–º–µ—Ç–æ–ª–æ–≥', 'services' => ['–º–∞–Ω–∏–∫—é—Ä', '–ø–µ–¥–∏–∫—é—Ä']],
            8 => ['location' => '–ë–∏–∑–Ω–µ—Å-—Ü–µ–Ω—Ç—Ä "–°–∏—Ç–∏"', 'floor' => '15', 'capacity' => 50]
        ];

        return $options[$scenarioId] ?? ['scenario_id' => $scenarioId, 'demo' => true];
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –ø–µ—Ä–µ–æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–π –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏ —Ä–µ—Å—É—Ä—Å–∞
     */
    private function getResourceOverridesForScenario(int $scenarioId): array
    {
        return [];
    }

    /**
     * –ü–æ–ª—É—á–µ–Ω–∏–µ –∫—Ä–∞—Ç–∫–æ–≥–æ –æ–ø–∏—Å–∞–Ω–∏—è –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
     */
    private function getConfigSummary(array $config): string
    {
        $parts = [];
        if (isset($config['require_confirmation'])) {
            $parts[] = $config['require_confirmation'] ? '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:—Ä—É—á–Ω–æ–µ' : '–ø–æ–¥—Ç–≤–µ—Ä–∂–¥–µ–Ω–∏–µ:–∞–≤—Ç–æ';
        }
        if (isset($config['slot_strategy'])) {
            $strategy = $config['slot_strategy'] === 'fixed' ? '—Ñ–∏–∫—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ' : '–¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏–µ';
            $parts[] = "—Å–ª–æ—Ç—ã:{$strategy}";
        }
        if (isset($config['slot_duration_minutes'])) {
            $parts[] = "–¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å:{$config['slot_duration_minutes']}–º–∏–Ω";
        }
        if (isset($config['max_participants'])) {
            $parts[] = "–º–∞–∫—Å:{$config['max_participants']}";
        }

        return implode(', ', $parts);
    }

    /**
     * –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function cleanupScenarioData(int $scenarioId): void
    {
        $companyId = $scenarioId * 100;
        Company::where('id', $companyId)->delete();
    }

    /**
     * –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ —Å—Ü–µ–Ω–∞—Ä–∏—è
     */
    private function storeScenarioResults(int $scenarioId, array $setupData): void
    {
        $filename = storage_path("app/demo/scenario_{$scenarioId}_results.json");

        $results = [
            'scenario_id' => $scenarioId,
            'company_id' => $setupData['company_id'],
            'resource_id' => $setupData['resource_id'],
            'timestamp' => now()->toISOString(),
            'description' => $this->getScenarioDescription($scenarioId),
            'config' => $this->getResourceConfigForScenario($scenarioId)
        ];

        if (!is_dir(dirname($filename))) {
            mkdir(dirname($filename), 0755, true);
        }

        file_put_contents($filename, json_encode($results, JSON_PRETTY_PRINT | JSON_UNESCAPED_UNICODE));
        $this->info("üìÑ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã –≤: {$filename}");
    }
}
